
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Running the Build &#8212; HTPolyNet 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DGEBA-PACM Thermoset" href="../2-DGEBA-PACM/index.html" />
    <link rel="prev" title="The Configuration File" href="configuration.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="running-the-build">
<span id="pms-run"></span><h1>Running the Build<a class="headerlink" href="#running-the-build" title="Permalink to this headline">¶</a></h1>
<p>Now, in our working directory <code class="docutils literal notranslate"><span class="pre">my_pms_build</span></code>, we are ready to launch HTPolyNet:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> my_pms_build
<span class="gp">$ </span>ls
<span class="go">pMSTY.yaml  lib/</span>
<span class="gp">$ </span>htpolynet run pMSTY.yaml -lib lib -log my_build.log --loglevel debug <span class="p">&amp;</span>
<span class="go">[1]</span>
<span class="gp">$ </span>ls
<span class="go">pMSTY.yaml  my_build.log  lib/  proj-0/</span>
<span class="gp">$</span>
</pre></div>
</div>
<p>HTPolyNet is instructed here to use the local <code class="docutils literal notranslate"><span class="pre">./lib/</span></code> as the molecule library; not including a value for <code class="docutils literal notranslate"><span class="pre">-lib</span></code> forces HTPolyNet to use the system library in the <code class="docutils literal notranslate"><span class="pre">Library</span></code> subpackage, and if you are making new molecules, they won’t be there.  It is also instructive to write logging messages to <code class="docutils literal notranslate"><span class="pre">my_build.log</span></code> at the <code class="docutils literal notranslate"><span class="pre">debug</span></code> (most informative) level.  The build can take several minutes, so we are running it in the background.  All the action is happening in <code class="docutils literal notranslate"><span class="pre">proj-0</span></code> (and of course being reportedon in <code class="docutils literal notranslate"><span class="pre">my_build.log</span></code>), so let’s look in there.</p>
<section id="parameterization-results">
<h2>Parameterization results<a class="headerlink" href="#parameterization-results" title="Permalink to this headline">¶</a></h2>
<p>The first major block of calculations involves parameterizing all required molecular templates.  So after a few minutes, we can inspect the parameterization results while the build continues:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> proj-0
<span class="gp">$ </span>ls
<span class="go">molecules/  plots/  systems/</span>
<span class="gp">$ </span><span class="nb">cd</span> molecules/parameterized
<span class="gp">$ </span>ls EMB.*
<span class="go">EMB.edr  EMB.frcmod  EMB.gro  EMB.grx  EMB.itp  EMB.log  EMB.mol2  EMB.top  EMB.tpr  EMB.trr</span>
<span class="gp">$</span>
</pre></div>
</div>
<p>What are we seeing here?  These are all the output files for generated by parameterization of the <code class="docutils literal notranslate"><span class="pre">EMB</span></code> residue defined in <code class="docutils literal notranslate"><span class="pre">lib/molecules/inputs/EMB.mol2</span></code>.  six distinct template molecules, along with the EMB monomer.  Each set comprises four files:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mol2</span></code> – output of <code class="docutils literal notranslate"><span class="pre">antechamber</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frcmod</span></code> – output of <code class="docutils literal notranslate"><span class="pre">parmchk2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gro/top/itp</span></code> – output of <code class="docutils literal notranslate"><span class="pre">parmed</span></code> (<code class="docutils literal notranslate"><span class="pre">gro</span></code> is also output of Gromacs minimization)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grx</span></code> – custom output of HTPolyNet with “extra” atom parameters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tpr/trr/edr</span></code> – files associated with a Gromacs-based energy minimization that produces an coordinate-optimized <code class="docutils literal notranslate"><span class="pre">gro</span></code> file.</p></li>
</ol>
<p>We can see how many molecules have been parameterized (each will have its own <code class="docutils literal notranslate"><span class="pre">gro</span></code> file):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls *.gro
<span class="go">&#39;EMB1_1~C1=C2~EMB1_1.gro&#39;  &#39;EMB1_1~C1=C2~EMB.gro&#39;   EMB1_1.gro  &#39;EMB~C1=C2~EMB1_1.gro&#39;   EMBCC.gro   EMB.gro</span>
</pre></div>
</div>
<p>The filesname in single-quotes are the ones corresponding to the automatically “chain-expanded” reactions. So we have parameterized every reaction product, and this is a sufficient set of templates.</p>
</section>
<section id="liquid-generation-and-densification">
<h2>Liquid generation and densification<a class="headerlink" href="#liquid-generation-and-densification" title="Permalink to this headline">¶</a></h2>
<p>After a few more minutes, when the densification MD simulation has finished, let’s back out of the <code class="docutils literal notranslate"><span class="pre">molecules/parameterized/</span></code> subdirectory and drop into <code class="docutils literal notranslate"><span class="pre">systems/init/</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> ../../systems/init
<span class="gp">$ </span>ls
<span class="go">EMB.gro                 mdout.mdp</span>
<span class="go">gmx.in                  minimize.mdp</span>
<span class="go">init.gro                npt-1.cpt</span>
<span class="go">init.grx                npt-1-density.xvg</span>
<span class="go">init-minimized.edr      npt-1.edr</span>
<span class="go">init-minimized.gro      npt-1.gro</span>
<span class="go">init-minimized.log      npt-1.log</span>
<span class="go">init-minimized.tpr      npt-1-out.xvg</span>
<span class="go">init-minimized.trr      npt-1.tpr</span>
<span class="go">init.top                npt-1.trr</span>
<span class="go">liquid-densify-npt.mdp</span>
<span class="gp">$</span>
</pre></div>
</div>
<p>HTPolyNet creates <code class="docutils literal notranslate"><span class="pre">init.top</span></code> by merging 100 EMB topologies together and writes it.  <code class="docutils literal notranslate"><span class="pre">init.gro</span></code> is created using <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">insert-molecules</span></code> using <code class="docutils literal notranslate"><span class="pre">EMB.gro</span></code> as input.  <code class="docutils literal notranslate"><span class="pre">init.grx</span></code> is created by HTPolyNet to store auxiliary atom attributes.  We can see the results of two <code class="docutils literal notranslate"><span class="pre">mdrun</span></code> invocations:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">minimize.mdp</span></code> and <code class="docutils literal notranslate"><span class="pre">init-minimized.*</span></code> – this is just an initial energy minimization of the system; and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">liquid-densify-npt.mdp</span></code> and <code class="docutils literal notranslate"><span class="pre">npt-1.*</span></code> – this is the densification MD simulation that runs until the density is equilibrated at the temperature and pressure specified in the <code class="docutils literal notranslate"><span class="pre">mdp</span></code> file.</p></li>
<li><p>Some <code class="docutils literal notranslate"><span class="pre">xvg</span></code> files are created by <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>, which is controlled non-interactively using <code class="docutils literal notranslate"><span class="pre">gmx.in</span></code>.  A plot of density vs. time is generated.</p></li>
</ol>
<p>Let’s go up out of <code class="docutils literal notranslate"><span class="pre">systems/init</span></code> and into <code class="docutils literal notranslate"><span class="pre">plots/</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> ../../plots
<span class="gp">$ </span>ls
<span class="go">init-density.png</span>
</pre></div>
</div>
<p>HTPolyNet automatically generates a plot of density vs. time for the densification simulation:</p>
<img alt="../../_images/init-density.png" src="../../_images/init-density.png" />
<p>We can see that we’ve successfully arrived at the liquid-like density of about 810 kg/m<sup>3</sup>. (The actual density is 860, so we are a bit low.)</p>
</section>
<section id="the-first-cure-iteration">
<h2>The first CURE iteration<a class="headerlink" href="#the-first-cure-iteration" title="Permalink to this headline">¶</a></h2>
<p>The next major part of the build is the first CURE iteration, which is the most expensive because the pair searching is most demanding when the number of reactive atoms is maximal.  So let’s back out of <code class="docutils literal notranslate"><span class="pre">plots</span></code> and drop into <code class="docutils literal notranslate"><span class="pre">systems/iter-1</span></code>.  When the iteration completes, there are a _lot_ of files generated.  They can be divided into five “phases” for each CURE iteration:</p>
<ol class="arabic simple" start="0">
<li><p>Bond search</p></li>
<li><p>Dragging</p></li>
<li><p>Topology update</p></li>
<li><p>Relaxation</p></li>
<li><p>Equilibration</p></li>
</ol>
<p>Names of files corresponding to phases 0-4 all begin with their respective digits.  Names of files that do not begin with a digit are “auxiliary”.  Let’s consider the files in the seven states.</p>
<section id="bondsearch-files">
<h3>Bondsearch files<a class="headerlink" href="#bondsearch-files" title="Permalink to this headline">¶</a></h3>
<p>Files associated with the bondsearch begin with <code class="docutils literal notranslate"><span class="pre">0</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls -1 <span class="m">0</span>-*
<span class="go">0-bondsearch-bonds.csv</span>
<span class="go">0-bondsearch.gro</span>
<span class="go">0-bondsearch.grx</span>
<span class="go">0-bondsearch-input.gro</span>
<span class="go">0-bondsearch.top</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gro</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> files are sufficient Gromacs input.  The <code class="docutils literal notranslate"><span class="pre">grx</span></code> file contains values of four extra attributes for each atom:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>head <span class="m">0</span>-bondsearch.grx
<span class="go">globalIdx  z  cycle-idx reactantName  nreactions</span>
<span class="go">        1  0          1          EMB           0</span>
<span class="go">        2  0          1          EMB           0</span>
<span class="go">        3  0          1          EMB           0</span>
<span class="go">        4  0          0          EMB           0</span>
<span class="go">        5  0          1          EMB           0</span>
<span class="go">        6  0          1          EMB           0</span>
<span class="go">        7  0          1          EMB           0</span>
<span class="go">        8  1          0          EMB           0</span>
<span class="go">        9  1          0          EMB           0</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">globalIdx</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">nr</span></code> attribute in the <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">atoms</span> <span class="pre">]</span></code> directive of a <code class="docutils literal notranslate"><span class="pre">top</span></code> file, or the <code class="docutils literal notranslate"><span class="pre">atomNum</span></code> attribute of a <code class="docutils literal notranslate"><span class="pre">gro</span></code> file; it is just the global atom index.  <code class="docutils literal notranslate"><span class="pre">z</span></code> is the current value of the number of available crosslink bonds for that atom.  <code class="docutils literal notranslate"><span class="pre">cycle-idx</span></code> are unique indices indicated which ring the atom belongs to; rings are labeled uniquely within a residue.  <code class="docutils literal notranslate"><span class="pre">reactantName</span></code> is initialized as the residue name the atom belongs to.  However, as we will see, this attribute is key for communicating which product template maps onto a set of particular residues that react.  Finally, <code class="docutils literal notranslate"><span class="pre">nreactions</span></code> simply reports the number of times this atom has participated in a reaction.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">csv</span></code> file is a dump of the bonds “DataFrame”:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>head <span class="m">0</span>-bondsearch-bonds.csv
<span class="go">ai aj reactantName order initial-distance</span>
<span class="go">239 2025 EMB1_1 1 0.3540478556636094</span>
<span class="go">953 975 EMB1_1 1 0.3623175402875217</span>
<span class="go">29 1794 EMB1_1 1 0.3648054275912023</span>
<span class="go">1037 1962 EMB1_1 1 0.3691002573827334</span>
<span class="go">1835 2088 EMB1_1 1 0.37332157719585396</span>
<span class="go">386 1269 EMB1_1 1 0.3767585433669687</span>
<span class="go">512 30 EMB1_1 1 0.3765328670913073</span>
<span class="go">1331 1941 EMB1_1 1 0.3772466886534595</span>
<span class="go">134 1206 EMB1_1 1 0.381443311646698</span>
</pre></div>
</div>
<p>The first two columns are pre-bond global atom indices for each bond-designate; the third column is the name of the product molecule template of the reaction type that forms this bond, and the fourth column is the instantaneous interatomic distance in nm.  This is the first real output of the bond search.  Later, in the “connect” stage, atoms listed here will inherit their <code class="docutils literal notranslate"><span class="pre">reactantName</span></code> from this structure.</p>
</section>
<section id="dragging-files">
<h3>Dragging files<a class="headerlink" href="#dragging-files" title="Permalink to this headline">¶</a></h3>
<p>Files associated with prebond dragging begin with <code class="docutils literal notranslate"><span class="pre">1</span></code>.  However, because no bond-designate length exceeded 0.5 nm, no dragging is triggered.  So the build proceeds to the topology update.</p>
</section>
<section id="topology-update-files">
<h3>Topology update files<a class="headerlink" href="#topology-update-files" title="Permalink to this headline">¶</a></h3>
<p>Files associated with the topology update process begin with a <code class="docutils literal notranslate"><span class="pre">2</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls -1 <span class="m">2</span>*
<span class="go">2-update-complete-bonds.csv</span>
<span class="go">2-update-complete.gro</span>
<span class="go">2-update-complete.grx</span>
<span class="go">2-update-complete.top</span>
<span class="go">2-update-idx-mapper.dat</span>
<span class="go">2-update-resid-graph.json</span>
</pre></div>
</div>
<p>All files here represent <strong>outputs</strong> of the topology update.  Let’s look at the <code class="docutils literal notranslate"><span class="pre">2-update-idx-mapper.dat</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tail <span class="m">2</span>-update-idx-mapper.dat
<span class="go">2089 1977</span>
<span class="go">2090 1978</span>
<span class="go">2091 1979</span>
<span class="go">2092 1980</span>
<span class="go">2093 1981</span>
<span class="go">2094 1982</span>
<span class="go">2095 1983</span>
<span class="go">2096 1984</span>
<span class="go">2098 1985</span>
<span class="go">2099 1986</span>
</pre></div>
</div>
<p>The purpose of this file is very simple:  The first column are atom indices <strong>before</strong> topology update, and the second column are indices <strong>after</strong> topology update.  Remember that topology updating deletes sacrificial hydrogens, which means atoms are reindexed (since Gromacs requires sequential atom indexes).  This file allows us to match any atoms in pre-update <code class="docutils literal notranslate"><span class="pre">gro</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> files to those that exist downstream of a topology update.  Note that I’ve chosen to show a <code class="docutils literal notranslate"><span class="pre">tail</span></code> of this file to highlight the largest index differences.  The post-update indexes also appear in the <code class="docutils literal notranslate"><span class="pre">csv</span></code> file showing all bonds.</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">2-update-complete-bonds.csv</span></code> is just the initial <code class="docutils literal notranslate"><span class="pre">0-bondsearch-bonds.csv</span></code>, except all the atom indexes have been updated according to the index mapper described above.  The last line in this file reports the new bond with the longest initial length:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>tail -1 <span class="m">2</span>-update-complete-bonds.csv
<span class="go">1033 581 EMB1_1 1 0.4951201874292745</span>
</pre></div>
</div>
<p>Again, the <code class="docutils literal notranslate"><span class="pre">gro</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> are proper Gromacs inputs, and the <code class="docutils literal notranslate"><span class="pre">grx</span></code> file tabulates all <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">cycle-idx</span></code>, <code class="docutils literal notranslate"><span class="pre">reactantName</span></code>, and <code class="docutils literal notranslate"><span class="pre">nreactions</span></code> attributes.  The <code class="docutils literal notranslate"><span class="pre">json</span></code> file represents the graph structure of the network on a resid basis in JSON format.</p>
</section>
<section id="relaxation-files">
<h3>Relaxation files<a class="headerlink" href="#relaxation-files" title="Permalink to this headline">¶</a></h3>
<p>Files that begin with a <code class="docutils literal notranslate"><span class="pre">3</span></code> correspond to bond relaxation stages.  In this example, six stages are run by virture of the bond-designate with the longest bond length (0.499 nm) and the <code class="docutils literal notranslate"><span class="pre">relax_increment</span></code> of 0.075 nm.  Each stage produces 22 output files: the bonds <code class="docutils literal notranslate"><span class="pre">csv</span></code>, the <code class="docutils literal notranslate"><span class="pre">gro</span></code> / <code class="docutils literal notranslate"><span class="pre">grx</span></code> / <code class="docutils literal notranslate"><span class="pre">top</span></code> that initializes the first stage, and then the 17 <strong>outputs</strong> from the minimization (5), nvt (6), and npt (6) sub-stages:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls <span class="m">3</span>-*
<span class="go">3-relax-stage-1-bonds.csv</span>
<span class="go">3-relax-stage-1.gro</span>
<span class="go">3-relax-stage-1.grx</span>
<span class="go">3-relax-stage-1-min.edr</span>
<span class="go">3-relax-stage-1-min.gro</span>
<span class="go">3-relax-stage-1-min.log</span>
<span class="go">3-relax-stage-1-min.tpr</span>
<span class="go">3-relax-stage-1-min.trr</span>
<span class="go">3-relax-stage-1-npt.cpt</span>
<span class="go">3-relax-stage-1-npt.edr</span>
<span class="go">3-relax-stage-1-npt.gro</span>
<span class="go">3-relax-stage-1-npt.log</span>
<span class="go">3-relax-stage-1-npt.tpr</span>
<span class="go">3-relax-stage-1-npt.trr</span>
<span class="go">3-relax-stage-1-nvt.cpt</span>
<span class="go">3-relax-stage-1-nvt.edr</span>
<span class="go">3-relax-stage-1-nvt.gro</span>
<span class="go">3-relax-stage-1-nvt.log</span>
<span class="go">3-relax-stage-1-nvt.tpr</span>
<span class="go">3-relax-stage-1-nvt.trr</span>
<span class="go">3-relax-stage-1.top</span>
<span class="go">...</span>
<span class="go">3-relax-stage-6-bonds.csv</span>
<span class="go">3-relax-stage-6.gro</span>
<span class="go">3-relax-stage-6.grx</span>
<span class="go">3-relax-stage-6-min.edr</span>
<span class="go">3-relax-stage-6-min.gro</span>
<span class="go">3-relax-stage-6-min.log</span>
<span class="go">3-relax-stage-6-min.tpr</span>
<span class="go">3-relax-stage-6-min.trr</span>
<span class="go">3-relax-stage-6-npt.cpt</span>
<span class="go">3-relax-stage-6-npt.edr</span>
<span class="go">3-relax-stage-6-npt.gro</span>
<span class="go">3-relax-stage-6-npt.log</span>
<span class="go">3-relax-stage-6-npt.tpr</span>
<span class="go">3-relax-stage-6-npt.trr</span>
<span class="go">3-relax-stage-6-nvt.cpt</span>
<span class="go">3-relax-stage-6-nvt.edr</span>
<span class="go">3-relax-stage-6-nvt.gro</span>
<span class="go">3-relax-stage-6-nvt.log</span>
<span class="go">3-relax-stage-6-nvt.tpr</span>
<span class="go">3-relax-stage-6-nvt.trr</span>
<span class="go">3-relax-stage-6.top</span>
</pre></div>
</div>
<p>The attenuation is managed by the sequential <code class="docutils literal notranslate"><span class="pre">top</span></code> files.  Let’s look at the entry for a particular bond (between atoms 581 and 1033) in each stage’s <code class="docutils literal notranslate"><span class="pre">top</span></code> file’s <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">bonds</span> <span class="pre">]</span></code> directive:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>grep <span class="s2">&quot;^581 1033&quot;</span> <span class="m">3</span>-relax-stage-?.top<span class="p">|</span>awk <span class="s1">&#39;{if ($3==1) print $0}&#39;</span>
<span class="go">3-relax-stage-1.top:581 1033 1 0.43822515619106206 41965.52</span>
<span class="go">3-relax-stage-2.top:581 1033 1 0.3813301249528497 83931.04</span>
<span class="go">3-relax-stage-3.top:581 1033 1 0.32443509371463725 125896.56</span>
<span class="go">3-relax-stage-4.top:581 1033 1 0.2675400624764248 167862.08</span>
<span class="go">3-relax-stage-5.top:581 1033 1 0.21064503123821238 209827.6</span>
<span class="go">3-relax-stage-6.top:581 1033 1 0.15375 251793.12</span>
<span class="gp">$</span>
</pre></div>
</div>
<p>In a <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">bonds</span> <span class="pre">]</span></code> topology directive, the 4th and 5th columns are <code class="docutils literal notranslate"><span class="pre">b0</span></code> and <code class="docutils literal notranslate"><span class="pre">kt</span></code> harmonic bond parameters.  In the stage-6 <code class="docutils literal notranslate"><span class="pre">top</span></code>, we see these parameters at their proper force-field values for a C-C single bond.  Notice how the value of the distance parameter <code class="docutils literal notranslate"><span class="pre">b0</span></code> begins at a large initial value and linearly decreases toward the target (but never by <em>more</em> than an increment of 0.075 nm), while the spring constant <code class="docutils literal notranslate"><span class="pre">kt</span></code> starts low and increases linearly toward its target.</p>
</section>
<section id="equilibration-files">
<h3>Equilibration files<a class="headerlink" href="#equilibration-files" title="Permalink to this headline">¶</a></h3>
<p>Files associated with final equilibration of the bonded system at the end of one CURE iteration begin with a <code class="docutils literal notranslate"><span class="pre">4</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls <span class="m">4</span>-*
<span class="go">4-equilibrate-bonds.csv</span>
<span class="go">4-equilibrate-complete-bonds.csv</span>
<span class="go">4-equilibrate-complete.gro</span>
<span class="go">4-equilibrate-complete.grx</span>
<span class="go">4-equilibrate-complete.top</span>
<span class="go">4-equilibrate.gro</span>
<span class="go">4-equilibrate.grx</span>
<span class="go">4-equilibrate.mdp</span>
<span class="go">4-equilibrate-post.cpt</span>
<span class="go">4-equilibrate-post.edr</span>
<span class="go">4-equilibrate-post.gro</span>
<span class="go">4-equilibrate-post.log</span>
<span class="go">4-equilibrate-post.tpr</span>
<span class="go">4-equilibrate-post.trr</span>
<span class="go">4-equilibrate.top</span>
</pre></div>
</div>
<p>Files with the simple prefix <code class="docutils literal notranslate"><span class="pre">4-equilibrate</span></code> represent inputs to the Gromacs run.  Files with the prefixs <code class="docutils literal notranslate"><span class="pre">4-equilibrate-post</span></code> are the raw Gromacs mdrun outputs, and the files with the prefix <code class="docutils literal notranslate"><span class="pre">4-equilibrate-complete</span></code> represent the Gromacs outputs read back in to HTPolyNet and processed.  This set of <code class="docutils literal notranslate"><span class="pre">complete</span></code> files are copied to the next CURE iteration directory as the set of <code class="docutils literal notranslate"><span class="pre">0-connect</span></code> files.</p>
</section>
</section>
<section id="subsequent-cure-iterations">
<h2>Subsequent CURE iterations<a class="headerlink" href="#subsequent-cure-iterations" title="Permalink to this headline">¶</a></h2>
<p>The primary result of a CURE iteration is the calculated conversion, or the fraction of the maximum number of crosslink bonds possible, based on the initial composition and reaction stoichiometries, that have formed up to that point. If this fraction is below the value associated with the <code class="docutils literal notranslate"><span class="pre">CURE_desired_conversion</span></code> option, then a new iteration is begun.  This involves creating the next <code class="docutils literal notranslate"><span class="pre">iter-n/</span></code> directory under <code class="docutils literal notranslate"><span class="pre">systems/</span></code>, and copying over the prior iteration’s <code class="docutils literal notranslate"><span class="pre">4-equilibrate-complete.top/gro/grx</span></code> files onto the new <code class="docutils literal notranslate"><span class="pre">0-bondsearch.top/gro/grx</span></code> files.  At the beginning of any CURE iterations, the maximum number of new bonds required to reach the desired conversion is calculated and used as a limit in creating new bonds, so that the desired conversion is hit exactly.</p>
<p>The number of CURE iterations needed to reach a specified conversion is never deterministic because of the randomness inherent in the inter-stage and post-bonding MD simulations.  In this particular instance, a total of 9 CURE iterations were required to reach 0.95 conversion.  Files for each iteration’s directory follow the same naming convention explained for the first iteration.</p>
</section>
<section id="post-cure-reactions-equilibration-and-finalization">
<h2>Post-cure reactions, equilibration, and finalization<a class="headerlink" href="#post-cure-reactions-equilibration-and-finalization" title="Permalink to this headline">¶</a></h2>
<p>After iteration 9, when the conversion specification is satisfied, HTPolyNet progresses to the post-cure stage.  The directory <code class="docutils literal notranslate"><span class="pre">systems/postcure</span></code> is created and the final outputs from the last CURE iterations are copied here.  If there were any monomers that had not yet reacted (here there are not), then the EMBCC reaction would be used to revert them back to double bonds, followed by an equilibration. After the equilibration, HTPolyNet generates the final files <code class="docutils literal notranslate"><span class="pre">7-final.top/gro/grx</span></code>.</p>
</section>
<section id="overall-behavior">
<h2>Overall behavior<a class="headerlink" href="#overall-behavior" title="Permalink to this headline">¶</a></h2>
<p>If the build is run with <code class="docutils literal notranslate"><span class="pre">--loglevel</span> <span class="pre">debug</span></code> indicated on the command-line, the log file will contain a lot of information that can be used to characterize the efficiency of the build process.  The <code class="docutils literal notranslate"><span class="pre">HTPolyNet.plot</span></code> module has a method <code class="docutils literal notranslate"><span class="pre">cure_graph</span></code> that can be used to generate plots showing the conversion vs. run time in hours, and the iteration number vs. run time in hours.  Generating this plot from the directory the log file is in can be done using an interactive python session:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">HTPolyNet.plot</span> <span class="kn">import</span> <span class="n">cure_graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cure_graph</span><span class="p">([</span><span class="s1">&#39;my_build.log&#39;</span><span class="p">],</span><span class="n">xmax</span><span class="o">=</span><span class="mf">20.</span><span class="p">)</span>
</pre></div>
</div>
<p>We ran 10 independent system builds of 100 monomers each using the provided <code class="docutils literal notranslate"><span class="pre">mol2</span></code> and <code class="docutils literal notranslate"><span class="pre">yaml</span></code> input files; they generated the logs <code class="docutils literal notranslate"><span class="pre">0.log</span></code>, <code class="docutils literal notranslate"><span class="pre">1.log</span></code>, …, <code class="docutils literal notranslate"><span class="pre">9.log</span></code>.  The plot below was made using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">HTPolyNet.plot</span> <span class="kn">import</span> <span class="n">cure_graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cure_graph</span><span class="p">([</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;[0-9].log&#39;</span><span class="p">)],</span><span class="n">xmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/iter-graph.png" src="../../_images/iter-graph.png" />
<p>In this case, on a moderately slow workstation, these builds took 10-15 minutes to reach 0.95 conversion, usually in 9 iterations.</p>
<p>Below is a trace of the density vs time as a concatenation of the sequence of all NPT MD simulations, beginning with the initial densification, passing through all drag/relaxationg/equilibrations in each iteration, and concluding with the final equilibration:</p>
<img alt="../../_images/all-density.png" src="../../_images/all-density.png" />
<p>It is clear that during the post-bond relaxations, density drops to 700 kg/m3, but this is because the post-bond relaxations are all run at 600 K.  The equilibrations at 300 K all bring the system back to approx. 900 kg/m3.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">HTPolyNet</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation and Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference-guide/index.html">Reference Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Example Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Poly(4-methyl styrene)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-DGEBA-PACM/index.html">DGEBA-PACM Thermoset</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Example Tutorials</a><ul>
  <li><a href="index.html">Poly(4-methyl styrene)</a><ul>
      <li>Previous: <a href="configuration.html" title="previous chapter">The Configuration File</a></li>
      <li>Next: <a href="../2-DGEBA-PACM/index.html" title="next chapter">DGEBA-PACM Thermoset</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Cameron Abrams, Ming Huang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/example-tutorials/1-polymethylstyrene/run.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>