
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Program Flow &#8212; HTPolyNet 1.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Molecular Structure Inputs" href="molecular-structure-inputs.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="program-flow">
<h1>Program Flow<a class="headerlink" href="#program-flow" title="Permalink to this heading">¶</a></h1>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/flow1.png"><img alt="outer program flow" src="../_images/flow1.png" style="width: 472.8px; height: 663.2px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">htpolynet</span> <span class="pre">run</span></code> workflow.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>A basic depiction of the the workflow initiated by <code class="docutils literal notranslate"><span class="pre">htpolynet</span> <span class="pre">run</span></code> is shown in the figure above.  The “0”th step is generation of the molecular structure data for any monomeric reactants, in the form of either Sybyl <code class="docutils literal notranslate"><span class="pre">mol2</span></code> or RCSB <code class="docutils literal notranslate"><span class="pre">pdb</span></code> files.  <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> does <strong>not</strong> do this, we provide some general guidance <a class="reference internal" href="molecular-structure-inputs.html#molecular-structure-inputs"><span class="std std-ref">here</span></a> and some specific example cases in the <a class="reference internal" href="../example-tutorials/index.html#example-tutorials"><span class="std std-ref">tutorials</span></a>.  Then, based on instructions in the <a class="reference internal" href="configuration-files.html#configuration-files"><span class="std std-ref">configuration file</span></a>, <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> proceeds with setting up all reactions and oligomer templates.  Once these are generated, it then generates the full initial system topology in Gromacs format (that is, it generates a <code class="docutils literal notranslate"><span class="pre">top</span></code> file), and an initial set of coordinates (a <code class="docutils literal notranslate"><span class="pre">gro</span></code> file).  Since the initial coordinates are built a low density (typically), <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> then performs MD to “densify” the system, followed by any pre-cure equilibration the user would like.  Then the <a class="reference internal" href="#cure-section"><span class="std std-ref">CURE algorithm</span></a> takes over to generate intermolecular bonds and drive the polymerization.  Once it finishes, <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> conducts any post-cure equilibration the user likes, before saving the final <code class="docutils literal notranslate"><span class="pre">top</span></code> and <code class="docutils literal notranslate"><span class="pre">gro</span></code> file.  All of this work happens in the project subdirectory of the current directory in which `` run`` is invoked.</p>
<p>This workflow should make clear that the two required tasks of the user are:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="molecular-structure-inputs.html#molecular-structure-inputs"><span class="std std-ref">Generating monomer structure files;</span></a> and</p></li>
<li><p><a class="reference internal" href="configuration-files.html#configuration-files"><span class="std std-ref">Creating an input configuration file.</span></a></p></li>
</ol>
</section>
<section id="connect-update-relax-equilibrate-cure-algorithm">
<span id="cure-section"></span><h1>Connect-Update-Relax-Equilibrate (CURE) algorithm<a class="headerlink" href="#connect-update-relax-equilibrate-cure-algorithm" title="Permalink to this heading">¶</a></h1>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/CURE.png"><img alt="picture of cure algorithm block flow diagram" src="../_images/CURE.png" style="width: 686.4000000000001px; height: 888.8000000000001px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Block flow diagram of the CURE algorithm used in <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code>.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The algorithm used to create new bonds and polymerize a system is called the CURE algorithm, depicted above.  This is just a slightly modified version of a standard search-radius-type algorithm, first used by Li and Strahan to study EPON/DETDA thermosets (<a class="reference external" href="https://doi.org/10.1016/j.polymer.2010.10.033">Li and Strahan, Polymer 2010;51,6058</a>).  The CURE algorithm begins by executing a search for new bonds on a frozen system configuration.  Bonds are downselected through a series of filters to arrive at a final set of bonds to form.  If the distance between any pair of “bond-designate” atoms is greater than some threshold (the <code class="docutils literal notranslate"><span class="pre">trigger_distance</span></code> parameter in the <a class="reference internal" href="configuration-files.html#cure-drag"><span class="std std-ref">drag subdirective</span></a> of the <code class="docutils literal notranslate"><span class="pre">CURE</span></code> directive of a configuration file), a series of MD simulations that slowly bring all to-be-bound atom closer together is performed.  Then the topology is updated, where <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> applies the charges, atom type, and bonded interaction templates from the oligomer template set to each bond.  After the update, a series of relaxation MD simulations bring all bonds to their equilibrium lengths.  Then a short NPT MD simulation equilibrates the overall density before initiating the next CURE iteration.  CURE iterations continue until (a) a desired conversion is reached, or (b) no new allowable bonds are identified.</p>
</section>
<section id="bondsearch-filters">
<span id="identifying-allowable-bonds-bondsearch-filters"></span><h1>Identifying allowable bonds:  Bondsearch filters<a class="headerlink" href="#bondsearch-filters" title="Permalink to this heading">¶</a></h1>
<p>A key task of <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> is identifying potential bonds between reactive atoms.  <code class="docutils literal notranslate"><span class="pre">HTPolyNet</span></code> organizes its “bondsearch” in any one CURE iteration along reactions.  Each reaction specified in the <a class="reference internal" href="configuration-files.html#configuration-files"><span class="std std-ref">configuration file</span></a> usually defines one bond by the identies of each reactant and the name of each atom in each reactant.  The bondsearch algorithm begins considering each reaction, and for each one, filtering the set of <em>possible</em> bonds using a series of rules, depicted below.</p>
<figure class="align-default" id="id3">
<img alt="../_images/bond_filter.png" src="../_images/bond_filter.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Bondsearch filtering in one CURE iteration.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The outer loop in this figure corresponds to an iteration over reactions.  An iteration consists of downselecting from all atoms to a set of pairs of atoms such that each member corresponds to one of the two atoms referred to in that reaction’s bond record.  This selection is also limited to those atoms that still have sacrificial hydrogens.  From this set, any potential bond that would result in a “short-circuit”, defined as two monomers that share <em>more</em> than one intermonomer bond, is excluded.  Then any potential bond that “pierces” a ring is excluded.  In the case that the polymerization chemistry involves opening of C-C double bonds, any potential bond that results in a “cycle” of C-C bonds of any length is excluded.  This now smaller set of potential bonds are then sorted by length and the topmost potential bonds (shortest) that do not repeat any monomer index are retained.  Then the entire set of potential bonds is considered at once to determine if any cycles of C-C bonds would form, and if so, the longst potential bond in any cycle is disallowed.  Then, for each bond, a random number between 0 and 1 is drawn and compared to its assigned probability; if the random draw is greater than the probability, the bond is disallowed.  Finally, if the current allowable conversion in the iteration is limited by a user directive, the longest bonds beyond this limit are also disallowed.  This final set of bonds is forwarded to the topology update; if this set is of zero length, the topology update immediately hands off to the radius checker.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">HTPolyNet</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation and Prerequisites</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Program Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-update-relax-equilibrate-cure-algorithm">Connect-Update-Relax-Equilibrate (CURE) algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bondsearch-filters">Identifying allowable bonds:  Bondsearch filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="molecular-structure-inputs.html">Molecular Structure Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html">Configuration Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example-tutorials/index.html">Example Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference-materials/index.html">Reference Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HTPolyNetPackage.html">HTPolyNet package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">User Guide</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="molecular-structure-inputs.html" title="next chapter">Molecular Structure Inputs</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Cameron Abrams, Ming Huang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/user-guide/program-flow.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>